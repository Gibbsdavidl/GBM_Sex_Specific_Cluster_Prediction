---
title: "STEP_4_5_AIM_1_JIVE_validation.Rmd"
output: html_document
date: "2023-10-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}

if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("GEOquery")

library(GEOquery)

library(org.Hs.eg.db)
```

## JIVE Validation

In the JIVE manuscript, there are three array expression data sets used for validation:
 GSE13041, GSE16011, and REMBRANDT

See: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE55918
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE13041
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE16011
https://link.springer.com/article/10.1007/s13402-014-0190-8#Sec20

```{r}
# load series and platform data from GEO
gset13041 <- getGEO("GSE13041", GSEMatrix =TRUE, AnnotGPL=TRUE)
gset16011 <- getGEO("GSE16011", GSEMatrix =TRUE, AnnotGPL=TRUE)
gsetPheno <- read_delim('../data/validation_metadata/GBM_meta_analysis.txt')

save(gset13041, gset16011, file = '../data/jive_validation_array_data.rda')


# make proper column names to match toptable 
fvarLabels(gset13041[[1]]) <- make.names(fvarLabels(gset13041[[1]]))

ex1 <- exprs(gset13041[[1]])

ph1 <- phenoData(gset13041[[1]])

phenotype_data <- pData(ph1)

# make proper column names to match toptable 
fvarLabels(gset16011[[1]]) <- make.names(fvarLabels(gset16011[[1]]))

ex1 <- exprs(gset16011[[1]])

ph1 <- phenoData(gset16011[[1]])

phenotype_data <- pData(ph1)

```








